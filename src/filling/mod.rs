// reference implementation of filling VM